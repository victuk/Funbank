<!DOCTYPE html>
<html class="wide wow-animation" lang="en">
  <head>
    <title>Login/Registration</title>
    <meta name="format-detection" content="telephone=no" />
    <meta
      name="viewport"
      content="width=device-width, height=device-height, initial-scale=1.0, maximum-scale=1.0, user-scalable=0"
    />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta charset="utf-8" />
    <!-- <script src="/cdn-cgi/apps/head/3ts2ksMwXvKRuG480KNifJ2_JNM.js"></script> -->
    <link rel="icon" href="images/favicon.ico" type="image/x-icon" />
    <!-- Stylesheets-->
    <link rel=”stylesheet” href=”build/css/intlTelInput.css”>
    <link rel="stylesheet" href="css/bootstrap.css" />
    <link rel="stylesheet" href="css/fonts.css" />
    <link rel="stylesheet" href="css/style.css" id="main-styles-link" />
    <link rel="stylesheet" href="./css/toastr.min.css" />
    <!-- <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script> -->

    <!--[if lt IE 10]>
      <div
        style="
          background: #212121;
          padding: 10px 0;
          box-shadow: 3px 3px 5px 0 rgba(0, 0, 0, 0.3);
          clear: both;
          text-align: center;
          position: relative;
          z-index: 1;
        "
      >
        <a href="https://windows.microsoft.com/en-US/internet-explorer/"
          ><img
            src="images/ie8-panel/warning_bar_0000_us.jpg"
            border="0"
            height="42"
            width="820"
            alt="You are using an outdated browser. For a faster, safer browsing experience, upgrade for free today."
        /></a>
      </div>
      <script src="js/html5shiv.min.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="preloader">
      <div class="preloader-body">
        <div class="cssload-container">
          <div class="cssload-speeding-wheel"></div>
        </div>
        <p>Loading...</p>
      </div>
    </div>
    <div class="page">
      <section class="section one-screen-page bg-primary-dark">
        <div class="one-screen-page-inner">
          <!-- Page Header-->
          <header class="section page-header">
            <!-- RD Navbar-->
            <div class="rd-navbar-wrap rd-navbar-absolute">
              <nav
                class="rd-navbar rd-navbar-transparent"
                data-layout="rd-navbar-fixed"
                data-sm-layout="rd-navbar-fixed"
                data-md-layout="rd-navbar-fixed"
                data-md-device-layout="rd-navbar-fixed"
                data-lg-layout="rd-navbar-static"
                data-lg-device-layout="rd-navbar-fixed"
                data-xl-layout="rd-navbar-static"
                data-xl-device-layout="rd-navbar-static"
                data-lg-stick-up-offset="20px"
                data-xl-stick-up-offset="20px"
                data-xxl-stick-up-offset="20px"
                data-lg-stick-up="true"
                data-xl-stick-up="true"
                data-xxl-stick-up="true"
              >
                <div class="rd-navbar-main-outer">
                  <div class="rd-navbar-main">
                    <!-- RD Navbar Panel-->
                    <div class="rd-navbar-panel">
                      <!-- RD Navbar Toggle-->
                      <button
                        class="rd-navbar-toggle"
                        data-rd-navbar-toggle=".rd-navbar-nav-wrap"
                      >
                        <span></span>
                      </button>
                      <!-- RD Navbar Brand-->
                      <div class="rd-navbar-brand">
                        <a class="brand" href="index.html">ZTE Bank</a>
                      </div>
                    </div>
                    <div class="rd-navbar-main-element">
                      <div class="rd-navbar-nav-wrap">
                        <!-- RD Navbar Nav-->
                        <ul class="rd-navbar-nav">
                          <li class="rd-nav-item active">
                            <a class="rd-nav-link" href="index.html">Home</a>
                            <!-- RD Navbar Dropdown-->
                            <!-- <ul class="rd-menu rd-navbar-dropdown">
                                <li class="rd-dropdown-item"><a class="rd-dropdown-link" href="index.html">Home 1</a></li>
                              </ul> -->
                          </li>
                          <li class="rd-nav-item">
                            <a class="rd-nav-link" href="login.html">Sign Up</a>
                          </li>

                          <li class="rd-nav-item">
                            <a
                              class="rd-nav-link button button-lg button-link"
                              href="/login.html"
                              >LOGIN</a
                            >
                          </li>
                        </ul>
                      </div>
                    </div>
                  </div>
                </div>
              </nav>
            </div>
          </header>
          <!-- LOGIN -->
          <div class="page-content text-center">
            <div class="container">
              <div class="row justify-content-center">
                <div class="col-md-10 col-lg-8 col-xl-4">
                  <!-- Tabs-->
                  <div
                    class="tabs-custom tabs-horizontal tabs-line"
                    id="tabs-1"
                  >
                    <!-- Nav tabs-->
                    <ul class="nav nav-tabs nav-tabs-inline">
                      <li class="nav-item" role="presentation">
                        <a
                          class="nav-link active"
                          href="#tabs-1-1"
                          data-bs-toggle="tab"
                          >Login</a
                        >
                      </li>
                      <li class="nav-item" role="presentation">
                        <a
                          class="nav-link"
                          href="#tabs-1-2"
                          data-bs-toggle="tab"
                          >Registration</a
                        >
                      </li>
                    </ul>
                    <!-- Tab panes-->
                    <div class="tab-content">
                      <div class="tab-pane fade show active" id="tabs-1-1">
                        <h4 class="text-dark">Login</h4>
                        <!-- RD Mailform-->
                        <form class="rd-form form-lg rd-mailform">
                          <div class="form-wrap">
                            <input
                              class="form-input"
                              id="login-email"
                              type="email"
                              name="email"
                              placeholder="Email"
                              data-constraints="@Email @Required"
                            />
                            <!-- <label class="form-label" for="login-email"
                              >E-mail</label
                            > -->
                          </div>
                          <div class="form-wrap">
                            <input
                              class="form-input"
                              id="login-password"
                              type="password"
                              name="password"
                              placeholder="Password"
                              data-constraints="@Required"
                            />
                            <!-- <label class="form-label" for="login-password"
                              >Password</label
                            > -->
                          </div>
                          <button
                            class="button button-lg button-round button-block button-primary"
                            type="submit"
                            id="login-button"
                          >
                            Login
                          </button>
                        </form>
                        <!-- <div class="group-sm group-sm-justify group-middle social-items"><span>or use</span><a class="icon icon-lg icon-gray-100 novi-icon fa fa-facebook" href="#"></a><a class="icon icon-lg icon-gray-100 novi-icon fa fa-twitter" href="#"></a></div> -->
                        <div style="margin-top: 35px;">
                          <a href="resetpassword.html">Reset Password</a>
                        </div>
                      </div>
                      <div class="tab-pane fade" id="tabs-1-2">
                        <h4 class="text-dark">Create Account</h4>
                        <!-- RD Mailform-->
                        <form class="rd-form form-lg">
                          <div class="form-wrap">
                            <input
                              class="form-input"
                              id="firstName"
                              type="text"
                              name="firstName"
                              data-constraints="@firstName @Required"
                            />
                            <label class="form-label" for="register-email"
                              >First Name</label
                            >
                          </div>
                          <div class="form-wrap">
                            <input
                              class="form-input"
                              id="lastName"
                              type="text"
                              name="lastName"
                              data-constraints="@lastName @Required"
                            />
                            <label class="form-label" for="register-email"
                              >Last Name</label
                            >
                          </div>
                          <div class="form-wrap">
                            <input
                              class="form-input"
                              id="register-email"
                              type="email"
                              name="email"
                              data-constraints="@Email @Required"
                            />
                            <label class="form-label" for="register-email"
                              >E-mail</label
                            >
                          </div>
                          <div class="form-wrap">
                            <input
                              class="form-input"
                              id="houseAddress"
                              type="text"
                              name="houseAddress"
                              data-constraints="@Required"
                            />
                            <label class="form-label" for="houseAddress"
                              >House Address</label
                            >
                          </div>
                          <div class="form-wrap">
                            <select
                              class="form-input"
                              name="country"
                              id="country"
                              type="country"
                              data-constraints="@Required"
                            >
                              <option>Country</option>
                            </select>
                            <!-- <input class="form-input" id="country" type="country" name="country" data-constraints="@Required"> -->
                            <!-- <label class="form-label" for="country">Country</label> -->
                          </div>
                          <div class="form-wrap">
                            <input
                              class="form-input"
                              id="phoneNumber"
                              type="tel"
                              name="phone number"
                              data-constraints="@Required"
                            />
                            <label class="form-label" for="phoneNumber"
                              >Phone Number</label
                            >
                          </div>
                          <div class="form-wrap">
                            <input
                              class="form-input custom-file-input"
                              type="file"
                              id="formFile"
                              accept="image/*"
                              name="customFileInput"
                            />
                            <label for="form-label" class="form-label"></label>
                          </div>
                          <div class="form-wrap">
                            <select
                              name="account-type"
                              id="accountType"
                              class="form-input form-select"
                              data-constraints="@Required"
                            >
                              <option>Account Type</option>
                              <option value="current">Current</option>
                              <option value="savings">Savings</option>
                            </select>
                            <!-- <label class="form-label" for="account-type"></label> -->
                          </div>
                          <div class="form-wrap">
                            <input
                              class="form-input"
                              id="register-password"
                              type="password"
                              name="password"
                              placeholder="Password"
                              data-constraints="@Required"
                            />
                            <!-- <label class="form-label" for="register-password"
                              >Password</label
                            > -->
                          </div>
                          <div class="form-wrap">
                            <input
                              class="form-input"
                              id="register-confirm-password"
                              type="password"
                              name="confirm-password"
                              placeholder="Confirm Password"
                              data-constraints="@Required"
                            />
                            <!-- <label
                              class="form-label"
                              for="register-confirm-password"
                              >Confirm Password</label
                            > -->
                          </div>

                          <button
                            class="button button-lg button-round button-block button-primary"
                            id="registerButton"
                          >
                            Register
                          </button>
                        </form>
                        <!-- <div class="group-sm group-sm-justify group-middle social-items"><span>or use</span><a class="icon icon-lg icon-gray-100 novi-icon fa fa-facebook" href="#"></a><a class="icon icon-lg icon-gray-100 novi-icon fa fa-twitter" href="#"></a></div> -->
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <div class="page-footer">
            <div class="container">
              <!-- Rights-->
              <p class="rights">
                <span>&copy;&nbsp; </span><span class="copyright-year"></span
                ><span>&nbsp;</span><span>All rights reserved</span
                ><span>.&nbsp;</span
                ><a href="privacy-policy.html">Privacy Policy</a>
              </p>
            </div>
          </div>
        </div>
      </section>
    </div>

    <style>
      .custom-file-input::-webkit-file-upload-button {
        visibility: hidden;
      }
      .custom-file-input::before {
        content: " Upload ID";
        display: inline-block;
        background: #fff;
        width: 100% !important;
        border: 0;
        outline: none;
      }
    </style>

    <script>
      document
        .querySelector(".custom-file-input")
        .addEventListener("change", function (e) {
          let name = document.getElementById("customFileInput").files[0].name;
          let nextSibling = e.target.nextElementSibling;
          nextSibling.innerText = name;
          console.log(nextSibling);
        });
    </script>
    <!-- Global Mailform Output-->
    <div class="snackbars" id="form-output-global"></div>
    <!-- Javascript-->
    <script src="js/core.min.js"></script>
    <script src="js/script.js"></script>
    <script src="./js/defaults.js"></script>
    <script src="./js/toast.min.js"></script>
    <script>
      const registerEmail = document.getElementById("register-email");
      const houseAddress = document.getElementById("houseAddress");
      let country = document.getElementById("country");
      const phoneNumber = document.getElementById("phoneNumber");
      const firstName = document.getElementById("firstName");
      const lastName = document.getElementById("lastName");
      const accountType = document.getElementById("accountType");
      let formFile = document.getElementById("formFile");
      const registerPassword = document.getElementById("register-password");
      const registerConfirmPassword = document.getElementById(
        "register-confirm-password"
      );
      const registerButton = document.getElementById("registerButton");

      const loginEmail = document.getElementById("login-email");
      const loginPassword = document.getElementById("login-password");
      const loginButton = document.getElementById("login-button");


      (function allCountries() {
        fetch("https://restcountries.com/v2/all")
          .then(async (response) => {
            if (response.status == 200) {
              const data = await response.json();
              for (let countrydata of data) {
                country.innerHTML += `<option value="${countrydata.name}">${countrydata.name}</option>`;
              }
            }
          })
          .catch((e) => {
            console.log(e);
          });
      })();

      loginButton.addEventListener("click", function(e) {
        e.preventDefault();
        if(loginPassword.value.length < 8) {
          iqwerty.toast.toast("Passwords needs to be at least 8 characters.");
          return;
        }

        fetch(baseUrl + "auth/login", {
          method: "POST",
          headers: {
            "Content-Type": "application/json"
          },
          body: JSON.stringify({
            emailOrAccountNumber: loginEmail.value,
            password:loginPassword.value
          })
        }).then(async (response) => {
          const data = await response.json();
          console.log(data);

          if(response.status == 200) {
            const auth = `${data.tokentype} ${data.token}`;

            localStorage.setItem("Authorization", auth);

            if(data.role == "user") {
              location.assign("/dashboard/user/index.html");
            } else if(data.role == "admin") {
              location.assign("/dashboard/admin/index.html");
            }
          } else {
            iqwerty.toast.toast(data.message);
          }

        }).catch(e => {
          console.log(e);
          iqwerty.toast.toast("An error occurred!");
        });

      });

      registerButton.addEventListener("click", function (e) {
        e.preventDefault();

        if(registerPassword.value.length < 8) {
          iqwerty.toast.toast("Passwords needs to be at least 8 characters.");
          return;
        }

        if(registerPassword.value != registerConfirmPassword.value) {
          iqwerty.toast.toast("Passswords don't match.");
          return;
        }

        const form = new FormData();
        form.append("uploadid", formFile.files[0]);
        form.append("email", registerEmail.value);
        form.append("homeAddress", houseAddress.value);
        form.append("country", country.value);
        form.append("phone", phoneNumber.value);
        form.append("password", registerPassword.value);
        form.append("firstName", firstName.value);
        form.append("lastName", lastName.value);
        form.append("accountType", accountType.value);

        fetch(baseUrl + "auth/register", {
          method: "POST",
          body: form,
        })
          .then(async (response) => {
            const data = await response.json();
            if (response.status == 201) {
              iqwerty.toast.toast('Account created. Kindly Check your email!');
              setTimeout(function () {
                location.reload();
              }, 2000);
            } else {
              iqwerty.toast.toast(data.message);
            }
          })
          .catch((e) => {
            console.log(e);
            iqwerty.toast.toast("Something went wrong!");
          });
      });
    </script>
  </body>
</html>
